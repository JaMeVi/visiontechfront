<mat-toolbar class="custom-toolbar" *ngIf="verificar()">
  <!-- Botón hamburguesa -->
  <button mat-icon-button class="menu-toggle" (click)="toggleMenu()">
    <mat-icon>{{ isMenuOpen ? 'close' : 'menu' }}</mat-icon>
  </button>

  <!-- Logo/Título centrado -->
  <div class="logo-container">
    <span class="logo-text">VISION TECH</span>
  </div>

  <!-- Botón de usuario a la derecha -->
  <div class="user-menu">
    <button mat-icon-button [matMenuTriggerFor]="menuSalir" class="user-button">
      <mat-icon>person</mat-icon>
    </button>
  </div>
</mat-toolbar>

<!-- Menú desplegable lateral -->
<div class="side-menu" [class.open]="isMenuOpen">
  <div class="side-menu-content">
    <!-- Header del menú -->
    <div class="menu-header">
      <h2>Menú Principal</h2>
      <button mat-icon-button (click)="toggleMenu()" class="close-menu">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- Enlaces del menú -->
    <nav class="menu-nav">
      <!-- Home -->
      <a mat-button [routerLink]="['/homes']" class="menu-item" (click)="closeMenu()">
        <mat-icon>home</mat-icon>
        <span>Home</span>
      </a>

      <!-- Roles (solo para DEVELOPER) -->
      <div class="menu-section" *ngIf="isTester()">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('roles')">
          <mat-icon>apps</mat-icon>
          <span>Roles</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['roles']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['roles']">
          <a mat-button routerLink="/roles" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/roles/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
          <a mat-button routerLink="/roles/busquedas" class="submenu-item" (click)="closeMenu()">Buscar por tipo</a>
        </div>
      </div>

      <!-- Usuarios (solo para TESTER) -->
      <div class="menu-section" *ngIf="isTester()">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('usuarios')">
          <mat-icon>people</mat-icon>
          <span>Usuarios</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['usuarios']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['usuarios']">
          <a mat-button routerLink="/usuarios" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/usuarios/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
        </div>
      </div>


      <!-- Rutas (solo para TESTER) -->
      <div class="menu-section" *ngIf="isTester()">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('rutas')">
          <mat-icon>route</mat-icon>
          <span>Rutas</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['rutas']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['rutas']">
          <a mat-button routerLink="/rutas" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/rutas/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
              <a mat-button routerLink="/rutas/mapa" class="submenu-item" (click)="closeMenu()">Ver Mapa</a>
              <a mat-button routerLink="/rutas/creardesdemapa" class="submenu-item" (click)="closeMenu()">Crear desde mapa</a>

        </div>
      </div>

      <!-- Mapa -->
<div class="menu-section">
  <a mat-button routerLink="/mapa" class="menu-item" (click)="closeMenu()">
    <mat-icon>map</mat-icon>
    <span>Mapa</span>
  </a>
</div>

<!-- Temas del Foro -->
<div class="menu-section">
  <button mat-button class="menu-item expandable" (click)="toggleSubmenu('temasforo')">
    <mat-icon>forum</mat-icon>
    <span>Temas Foro</span>
    <mat-icon class="expand-icon" [class.rotated]="openSubmenus['temasforo']">expand_more</mat-icon>
  </button>
  <div class="submenu" [class.open]="openSubmenus['temasforo']">
    <a mat-button routerLink="/temasforo" class="submenu-item" (click)="closeMenu()">Listar</a>
    <a mat-button routerLink="/temasforo/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
  </div>
</div>

<!-- Respuestas del Foro -->
<div class="menu-section">
  <button mat-button class="menu-item expandable" (click)="toggleSubmenu('respuestas')">
    <mat-icon>question_answer</mat-icon>
    <span>Respuestas</span>
    <mat-icon class="expand-icon" [class.rotated]="openSubmenus['respuestas']">expand_more</mat-icon>
  </button>
  <div class="submenu" [class.open]="openSubmenus['respuesta']">
    <a mat-button routerLink="/respuestas" class="submenu-item" (click)="closeMenu()">Listar</a>
    <a mat-button routerLink="/respuestas/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
  </div>
</div>



      <!-- Métricas -->
      <div class="menu-section">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('metricas')">
          <mat-icon>analytics</mat-icon>
          <span>Métricas</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['metricas']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['metricas']">
          <a mat-button routerLink="/metricas" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/metricas/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
        </div>
      </div>

      <!-- Condiciones Atmosféricas -->
      <div class="menu-section">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('atmosfericas')">
          <mat-icon>cloud</mat-icon>
          <span>Condiciones Atmosféricas</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['atmosfericas']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['atmosfericas']">
          <a mat-button routerLink="/catmosferica" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/catmosferica/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
        </div>
      </div>

      <!-- Incidentes -->
      <div class="menu-section">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('incidentes')">
          <mat-icon>warning</mat-icon>
          <span>Incidentes</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['incidentes']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['incidentes']">
          <a mat-button routerLink="/incidentes" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/incidentes/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
        </div>
      </div>

      <!-- Recomendaciones -->
      <div class="menu-section">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('recomendaciones')">
          <mat-icon>lightbulb</mat-icon>
          <span>Recomendaciones</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['recomendaciones']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['recomendaciones']">
          <a mat-button routerLink="/recomendaciones" class="submenu-item" (click)="closeMenu()">Listar</a>
          <a mat-button routerLink="/recomendaciones/inserciones" class="submenu-item" (click)="closeMenu()">Registrar</a>
        </div>
      </div>

      <!-- Contactos de Emergencia -->
      <div class="menu-section">
        <button mat-button class="menu-item expandable" (click)="toggleSubmenu('emergencia')">
          <mat-icon>emergency</mat-icon>
          <span>Contactos de Emergencia</span>
          <mat-icon class="expand-icon" [class.rotated]="openSubmenus['emergencia']">expand_more</mat-icon>
        </button>
        <div class="submenu" [class.open]="openSubmenus['emergencia']">
          <a mat-button routerLink="/contactoemergencia" class="submenu-item" (click)="closeMenu()">Listar</a>
        </div>
      </div>
    </nav>

    <!-- Footer del menú -->
    <div class="menu-footer">
      <div class="user-info">
        <mat-icon>person</mat-icon>
        <span>Rol: {{ rol || 'No definido' }}</span>
      </div>
    </div>
  </div>
</div>

<!-- Overlay para cerrar el menú -->
<div class="menu-overlay" [class.open]="isMenuOpen" (click)="closeMenu()"></div>

<!-- Menú de usuario (mantiene el original) -->
<mat-menu #menuSalir="matMenu">
  <button mat-menu-item routerLink="/login" (click)="cerrar()">
    <mat-icon>logout</mat-icon>
    <span>Cerrar sesión</span>
  </button>
  <button mat-menu-item>
    <mat-icon>account_circle</mat-icon>
    <span>Rol: {{ rol || 'No definido' }}</span>
  </button>
</mat-menu>